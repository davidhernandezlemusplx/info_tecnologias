<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>lucene-config</title>
    <style>
        body{font-family:Arial,sans-serif;line-height:1.6;max-width:900px;margin:0 auto;padding:20px;}
        pre{background:#f5f5f5;padding:1em;overflow-x:auto;}
        code{font-family:Consolas,monospace;}
        h1,h2,h3{color:#2c3e50;}
        table{border-collapse:collapse;width:100%;margin:1em 0;}
        th,td{border:1px solid #ddd;padding:8px;text-align:left;}
        th{background-color:#f2f2f2;}
        tr:nth-child(even){background-color:#f9f9f9;}
        a{color:#3498db;text-decoration:none;}
        a:hover{text-decoration:underline;}
        .breadcrumb{background:#f8f9fa;padding:8px 15px;border-radius:4px;margin-bottom:20px;}
        .breadcrumb a{color:#6c757d;}
        .breadcrumb a:hover{color:#0056b3;}
    </style>
</head>
<body><div class="breadcrumb"><a href="../index.html">Inicio</a> / <span>pliegos-tecnicos</span></div><h1>Configuración de Apache Lucene en Contenedores</h1>
<p><img alt="raw" src="../../images/lucene/lucene.png" /></p>
<p>Este documento describe cómo configurar Apache Lucene para indexación y búsqueda de texto en un entorno containerizado, asegurando compatibilidad con todas las plataformas (Linux, macOS, Windows, incluyendo WSL).</p>
<h2>Tabla de Contenidos</h2>
<ul>
<li><a href="#configuración-de-apache-lucene-en-contenedores">Configuración de Apache Lucene en Contenedores</a></li>
<li><a href="#tabla-de-contenidos">Tabla de Contenidos</a></li>
<li><a href="#prerrequisitos">Prerrequisitos</a></li>
<li><a href="#paso-1-crear-un-proyecto-maven-para-lucene">Paso 1: Crear un Proyecto Maven para Lucene</a></li>
<li><a href="#paso-2-crear-un-docker-compose-file">Paso 2: Crear un Docker Compose File</a></li>
<li><a href="#paso-2-desplegar-lucene-con-docker-compose">Paso 2: Desplegar Lucene con Docker Compose</a><ul>
<li><a href="#gestión-rápida-con-makefile">Gestión rápida con Makefile</a></li>
</ul>
</li>
<li><a href="#paso-3-desplegar-lucene-con-docker-compose">Paso 3: Desplegar Lucene con Docker Compose</a></li>
<li><a href="#paso-4-verificar-el-despliegue">Paso 4: Verificar el Despliegue</a></li>
<li><a href="#paso-5-integración-con-otros-sistemas">Paso 5: Integración con Otros Sistemas</a><ul>
<li><a href="#dependencias-maven-necesarias">Dependencias Maven necesarias</a></li>
<li><a href="#dependencias-maven">Dependencias Maven</a></li>
</ul>
</li>
<li><a href="#paso-6-gestión-del-contenedor-de-lucene">Paso 6: Gestión del Contenedor de Lucene</a></li>
<li><a href="#consejos-para-compatibilidad-multiplataforma">Consejos para Compatibilidad Multiplataforma</a></li>
<li><a href="#resolución-de-problemas">Resolución de Problemas</a></li>
<li><a href="#recursos-adicionales">Recursos Adicionales</a></li>
<li><a href="#volver-a-su-ficha">Volver a su ficha</a></li>
</ul>
<h2>Prerrequisitos</h2>
<p>Antes de comenzar, asegúrate de lo siguiente:</p>
<ul>
<li><strong>Docker</strong> está instalado y en ejecución.</li>
<li><strong>Docker Compose</strong> está instalado (se recomienda la versión 2.29.x o superior). Verifica con:</li>
</ul>
<blockquote>
<p>Puedes utilizar el script de <code>docker_install.sh</code> de la carpeta <code>/resources</code> para instalar ambas cosas en WSL/Ubuntu.</p>
</blockquote>
<ul>
<li>Tienes suficiente espacio en disco para los índices de Lucene (al menos 1GB para pruebas).</li>
<li>Un entorno de desarrollo Java (si deseas trabajar fuera del contenedor). La configuración usará un contenedor con Java y Maven preinstalados.</li>
</ul>
<h2>Paso 1: Crear un Proyecto Maven para Lucene</h2>
<p>Lucene es una biblioteca Java, por lo que crearemos un proyecto Maven para gestionar dependencias y ejecutarlo en un contenedor. Crea una estructura de directorio y los archivos necesarios. Tambien puedes usar los ficheros pregenerados de la carpeta <code>resources/lucene/</code>. Este enfoque asegura consistencia entre plataformas.</p>
<p>docker-compose.yml</p>
<pre><code class="language-yml">services:
  lucene:
    image: maven:3.9.8-eclipse-temurin-11
    container_name: lucene
    volumes:
      - ./:/app
      - lucene_data:/lucene-index
    working_dir: /app
    command: mvn clean compile exec:java -Dexec.mainClass=com.example.LuceneExample
    healthcheck:
      test: [&quot;CMD&quot;, &quot;ls&quot;, &quot;/lucene-index&quot;]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  lucene_data:
</code></pre>
<p>pom.xml</p>
<pre><code class="language-xml">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;lucene-example&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;
            &lt;artifactId&gt;lucene-core&lt;/artifactId&gt;
            &lt;version&gt;9.11.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;
            &lt;artifactId&gt;lucene-analysis-common&lt;/artifactId&gt;
            &lt;version&gt;9.11.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;
            &lt;artifactId&gt;lucene-queryparser&lt;/artifactId&gt;
            &lt;version&gt;9.11.1&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.13.0&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;11&lt;/source&gt;
                    &lt;target&gt;11&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre>
<p>LuceneExample.java</p>
<pre><code class="language-java">src/main/java/com/example/LuceneExample.java
package com.example;

import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.document.*;
import org.apache.lucene.index.*;
import org.apache.lucene.queryparser.classic.QueryParser;
import org.apache.lucene.search.*;
import org.apache.lucene.store.*;

import java.nio.file.*;
import java.io.*;
import java.util.*;

public class LuceneExample {
    public static void main(String[] args) throws Exception {
        String indexPath = &quot;/lucene-index&quot;;
        String docsPath = &quot;docs&quot;; // Carpeta con varios txt
        String busqueda = args.length &gt; 0 ? args[0] : &quot;búsqueda&quot;;

        FSDirectory directory = FSDirectory.open(Paths.get(indexPath));
        StandardAnalyzer analyzer = new StandardAnalyzer();
        IndexWriterConfig config = new IndexWriterConfig(analyzer);

        // Indexar todos los archivos txt de la carpeta docs
        try (IndexWriter writer = new IndexWriter(directory, config)) {
            Files.list(Paths.get(docsPath))
                .filter(path -&gt; path.toString().endsWith(&quot;.txt&quot;))
                .forEach(path -&gt; {
                    try {
                        String content = Files.readString(path);
                        Document doc = new Document();
                        doc.add(new TextField(&quot;content&quot;, content, Field.Store.YES));
                        doc.add(new StringField(&quot;filename&quot;, path.getFileName().toString(), Field.Store.YES));
                        writer.addDocument(doc);
                        System.out.println(&quot;[INDEXADO] &quot; + path.getFileName());
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                });
        }

        try (DirectoryReader reader = DirectoryReader.open(directory)) {
            IndexSearcher searcher = new IndexSearcher(reader);
            QueryParser parser = new QueryParser(&quot;content&quot;, analyzer);
            Query query = parser.parse(busqueda);

            TopDocs results = searcher.search(query, 10);
            System.out.println(&quot;\nResultados encontrados: &quot; + results.totalHits.value);

            for (ScoreDoc scoreDoc : results.scoreDocs) {
                Document resultDoc = searcher.doc(scoreDoc.doc);
                String filename = resultDoc.get(&quot;filename&quot;);
                String content = resultDoc.get(&quot;content&quot;);
                float score = scoreDoc.score;

                System.out.println(&quot; - Archivo: &quot; + filename);
                System.out.printf(&quot;   Score: %.4f%n&quot;, score);

                // Contar ocurrencias (ignorando mayúsculas/minúsculas)
                int count = countOccurrences(content.toLowerCase(), busqueda.toLowerCase());
                System.out.println(&quot;   Ocurrencias de '&quot; + busqueda + &quot;': &quot; + count);

                // Mostrar líneas donde aparece la palabra
                List&lt;Integer&gt; lines = findLinesContainingWord(content, busqueda);
                System.out.print(&quot;   Líneas: &quot;);
                if (lines.isEmpty()) {
                    System.out.println(&quot;No se encontraron líneas (¿indexado reciente?)&quot;);
                } else {
                    System.out.println(lines);
                }
            }
        }
    }

    // Método para contar cuántas veces aparece una palabra en el texto
    private static int countOccurrences(String text, String word) {
        int count = 0;
        int idx = 0;
        while ((idx = text.indexOf(word, idx)) != -1) {
            count++;
            idx += word.length();
        }
        return count;
    }

    // Método para encontrar números de línea que contienen la palabra
    private static List&lt;Integer&gt; findLinesContainingWord(String content, String word) {
        List&lt;Integer&gt; lines = new ArrayList&lt;&gt;();
        String[] splitLines = content.split(&quot;\\r?\\n&quot;);
        for (int i = 0; i &lt; splitLines.length; i++) {
            if (splitLines[i].toLowerCase().contains(word.toLowerCase())) {
                lines.add(i + 1); // Índice de línea empezando en 1
            }
        }
        return lines;
    }
}
</code></pre>
<ul>
<li><strong>Explicación</strong>:</li>
<li><strong>pom.xml</strong>: Define un proyecto Maven con las dependencias de Lucene (<code>lucene-core</code>, <code>lucene-analysis-common</code>, <code>lucene-queryparser</code>) en la versión 9.11.1 (la más reciente a julio de 2025). Usa Java 11 para compatibilidad.</li>
<li><strong>LuceneExample.java</strong>: Implementa el ejemplo proporcionado, creando un índice, añadiendo un documento y realizando una búsqueda. El directorio de índices se establece en <code>/lucene-index</code> para usarlo dentro del contenedor.</li>
<li><strong>Estructura</strong>: Crea la estructura de directorios estándar de Maven (<code>src/main/java/com/example</code>).</li>
</ul>
<h2>Paso 2: Crear un Docker Compose File</h2>
<p>Crea un archivo <code>docker-compose.yml</code> para ejecutar el proyecto Lucene en un contenedor con Java y Maven, asegurando portabilidad.</p>
<pre><code class="language-bash">cat &lt;&lt;EOF &gt; docker-compose.yml
services:
  lucene:
    image: maven:3.9.8-eclipse-temurin-11
    container_name: lucene
    volumes:
      - ./:/app
      - lucene_data:/lucene-index
    working_dir: /app
    command: mvn clean compile exec:java -Dexec.mainClass=com.example.LuceneExample
    healthcheck:
      test: [&quot;CMD&quot;, &quot;ls&quot;, &quot;/lucene-index&quot;]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  lucene_data:
EOF
</code></pre>
<ul>
<li><strong>Explicación</strong>:</li>
<li><strong>Imagen</strong>: Usa <code>maven:3.9.8-eclipse-temurin-11</code>, que incluye Maven 3.9.8 y Java 11, compatible con Lucene.</li>
<li><strong>Container Name</strong>: Asigna el nombre <code>lucene</code> para referencia sencilla.</li>
<li><strong>Volúmenes</strong>:<ul>
<li>Monta el directorio local (<code>./</code>) en <code>/app</code> para acceder al proyecto Maven.</li>
<li>Usa un volumen Docker <code>lucene_data</code> para persistir los índices en <code>/lucene-index</code>.</li>
</ul>
</li>
<li><strong>Comando</strong>: Ejecuta <code>mvn clean compile exec:java</code> para compilar y ejecutar la clase <code>LuceneExample</code>.</li>
<li><strong>Healthcheck</strong>: Verifica que el directorio de índices exista, indicando que el contenedor está operativo.</li>
</ul>
<h2>Paso 2: Desplegar Lucene con Docker Compose</h2>
<p>Inicia los contenedores usando Docker Compose.</p>
<pre><code class="language-bash">docker-compose up -d
</code></pre>
<ul>
<li><strong>Explicación</strong>:</li>
<li>El flag <code>-d</code> ejecuta los contenedores en segundo plano.</li>
<li>
<p>Verifica que los contenedores estén en ejecución:</p>
<p><code>bash
docker ps</code></p>
<p>Deberías ver el contenedor <code>lucene</code>.</p>
</li>
</ul>
<hr />
<h3>Gestión rápida con Makefile</h3>
<p>En la carpeta <code>resources/lucene/</code> tienes un <code>Makefile</code> preparado para gestionar Lucene fácilmente:</p>
<pre><code class="language-makefile">LUCENE_COMPOSE=docker-compose.yml

up:
    docker compose -f $(LUCENE_COMPOSE) up -d

down:
    docker compose -f $(LUCENE_COMPOSE) down

restart:
    docker compose -f $(LUCENE_COMPOSE) restart

logs:
    docker compose -f $(LUCENE_COMPOSE) logs -f
</code></pre>
<p>Ejecuta los siguientes comandos desde esa carpeta:</p>
<ul>
<li>Levantar Lucene:</li>
</ul>
<p><code>bash
  make up</code></p>
<ul>
<li>Parar Lucene:</li>
</ul>
<p><code>bash
  make down</code></p>
<ul>
<li>Reiniciar Lucene:</li>
</ul>
<p><code>bash
  make restart</code></p>
<ul>
<li>Ver logs:</li>
</ul>
<p><code>bash
  make logs</code></p>
<blockquote>
<p><strong>Nota:</strong> Para usar los comandos <code>make</code>, asegúrate de tener instalado el paquete <code>make</code>.
Puedes instalarlo en sistemas basados en Debian/Ubuntu con:</p>
</blockquote>
<pre><code class="language-bash">sudo apt install make
</code></pre>
<hr />
<h2>Paso 3: Desplegar Lucene con Docker Compose</h2>
<p>Inicia el contenedor para compilar y ejecutar el programa Lucene.</p>
<pre><code class="language-bash">docker-compose up -d
</code></pre>
<ul>
<li><strong>Explicación</strong>:</li>
<li>El flag <code>-d</code> ejecuta el contenedor en segundo plano.</li>
<li>El contenedor compila el proyecto y ejecuta el programa, creando un índice y mostrando los resultados de la búsqueda.</li>
<li>
<p>Verifica que el contenedor esté en ejecución:</p>
<p><code>bash
docker ps</code></p>
</li>
</ul>
<h2>Paso 4: Verificar el Despliegue</h2>
<ol>
<li><strong>Comprobar los Logs</strong>:
   Revisa los logs del contenedor para confirmar que el programa se ejecutó correctamente:</li>
</ol>
<p><code>bash
   docker logs lucene</code></p>
<p>Deberías ver una salida como:</p>
<p>```txt
    [INDEXADO] documento.txt
    [INDEXADO] inteligencia_artificial.txt</p>
<pre><code>Resultados encontrados: 1
- Archivo: documento.txt
  Score: 0.5915
  Ocurrencias de 'búsqueda': 14
  Líneas: [3, 5, 7, 11, 13, 15, 17, 19, 23, 29]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  10.074 s
[INFO] Finished at: 2025-07-04T11:57:04Z
[INFO] ------------------------------------------------------------------------
</code></pre>
<p>```</p>
<blockquote>
<p>EXPLICACIÓN: Dado dos ficheros de texto en la carpeta /docs, se ha buscado una palabra clave "búsqueda", que solo aparece en el fichero "documento.txt", y que además, aparece 14 veces indicandote las líneas en cuestión.</p>
</blockquote>
<ol>
<li><strong>Inspeccionar los Índices</strong>:
   Verifica que los índices se crearon en el volumen:</li>
</ol>
<p><code>bash
   docker volume ls | grep lucene_data
   docker run --rm -v lucene_lucene_data:/lucene-index alpine ls /lucene-index</code></p>
<p>Deberías ver archivos como <code>segments_1_</code>, <code>_0.cfs</code>, etc., indicando que el índice fue creado.</p>
<p>También se puede hacer de forma interactiva en el contenedor:</p>
<pre><code>```bash
 docker run --rm -it -v lucene_lucene_data:/lucene-index alpine sh
 ls /lucene-index/
```
</code></pre>
<h2>Paso 5: Integración con Otros Sistemas</h2>
<p>Apache Lucene puede integrarse con otros sistemas para enriquecer las capacidades de indexación y búsqueda, como MinIO para almacenamiento distribuido o Kafka para ingestión en tiempo real de datos. A continuación, se describen ejemplos de integración con ambos.</p>
<ol>
<li><strong>Integración con MinIO</strong>:</li>
</ol>
<p>MinIO es un sistema de almacenamiento compatible con API S3 que permite guardar índices Lucene en la nube o en almacenamiento distribuido.</p>
<p>### Dependencias Maven necesarias</p>
<p>Además de las dependencias básicas de Lucene, añade la dependencia para lucene-s3-directory y el AWS SDK:</p>
<p><code>xml
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;
        &lt;artifactId&gt;lucene-s3-directory&lt;/artifactId&gt;
        &lt;version&gt;9.11.1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;
        &lt;artifactId&gt;aws-java-sdk-s3&lt;/artifactId&gt;
        &lt;version&gt;1.12.540&lt;/version&gt;
    &lt;/dependency&gt;</code></p>
<p>Ejemplo básico para configurar el cliente S3 y usar S3Directory con MinIO:</p>
<p>```java
      import com.amazonaws.auth.AWSStaticCredentialsProvider;
      import com.amazonaws.auth.BasicAWSCredentials;
      import com.amazonaws.client.builder.AwsClientBuilder;
      import com.amazonaws.services.s3.AmazonS3;
      import com.amazonaws.services.s3.AmazonS3ClientBuilder;
      import org.apache.lucene.store.s3.S3Directory;</p>
<pre><code>  public class LuceneMinIOExample {
      public static void main(String[] args) throws Exception {
          // Configura las credenciales (usa variables de entorno o config externa en producción)
          BasicAWSCredentials creds = new BasicAWSCredentials("admin", "admin123");

          // Configura el cliente S3 para MinIO (endpoint local)
          AmazonS3 s3Client = AmazonS3ClientBuilder.standard()
              .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration("http://localhost:9000", "us-east-1"))
              .withCredentials(new AWSStaticCredentialsProvider(creds))
              .withPathStyleAccessEnabled(true) // Importante para MinIO
              .build();

          // Define el bucket y el prefijo para el índice
          String bucketName = "my-bucket";
          String indexPrefix = "lucene-index";

          // Crea el directorio S3 para Lucene
          S3Directory s3Directory = new S3Directory(s3Client, bucketName, indexPrefix);

          // Aquí continuarías con la creación del IndexWriter, etc.
      }
  }
</code></pre>
<p>```</p>
<ol>
<li><strong>Integración con Kafka</strong>:</li>
</ol>
<p>Kafka es una plataforma de mensajería distribuida muy usada para manejar flujos de datos en tiempo real. Puedes consumir mensajes y enviar su contenido para indexación en Lucene.</p>
<p>### Dependencias Maven</p>
<p>Añade la dependencia oficial de Kafka para Java:</p>
<pre><code>```xml
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
    &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;
    &lt;version&gt;3.5.1&lt;/version&gt;
  &lt;/dependency&gt;
```

Ejemplo básico de consumidor Kafka en Java con indexación en Lucene
</code></pre>
<p>```java
      import org.apache.kafka.clients.consumer.ConsumerRecord;
      import org.apache.kafka.clients.consumer.ConsumerRecords;
      import org.apache.kafka.clients.consumer.KafkaConsumer;
      import org.apache.lucene.document.Document;
      import org.apache.lucene.document.Field;
      import org.apache.lucene.document.TextField;
      import org.apache.lucene.index.IndexWriter;</p>
<pre><code>  import java.time.Duration;
  import java.util.Arrays;
  import java.util.Properties;

  public class LuceneKafkaConsumer {
      public static void main(String[] args) {
          Properties props = new Properties();
          props.put("bootstrap.servers", "localhost:29092");
          props.put("group.id", "lucene-group");
          props.put("auto.offset.reset", "earliest");
          props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
          props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

          KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
          consumer.subscribe(Arrays.asList("test-topic"));

          // Supón que indexWriter ya está inicializado y es thread-safe o se sincroniza
          IndexWriter indexWriter = /* inicializa tu IndexWriter aquí */;

          try {
              while (true) {
                  ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofSeconds(1));
                  for (ConsumerRecord&lt;String, String&gt; record : records) {
                      Document doc = new Document();
                      doc.add(new TextField("content", record.value(), Field.Store.YES));
                      // Añadir más campos si quieres (timestamp, key, etc.)

                      indexWriter.addDocument(doc);
                  }
                  indexWriter.commit(); // confirma cambios periódicamente
              }
          } catch (Exception e) {
              e.printStackTrace();
          } finally {
              consumer.close();
              try {
                  indexWriter.close();
              } catch (Exception e) {
                  e.printStackTrace();
              }
          }
      }
  }
</code></pre>
<p>```</p>
<h2>Paso 6: Gestión del Contenedor de Lucene</h2>
<ul>
<li><strong>Detener el Contenedor</strong>:</li>
</ul>
<p><code>bash
  docker-compose down</code></p>
<p>Esto detiene y elimina el contenedor, pero conserva el volumen <code>lucene_data</code>.</p>
<ul>
<li><strong>Reiniciar el Contenedor</strong>:</li>
</ul>
<p><code>bash
  docker-compose up -d</code></p>
<ul>
<li><strong>Eliminar el Volumen (si es necesario)</strong>:
  Para borrar todos los índices:</li>
</ul>
<p><code>bash
  docker volume rm lucene-project_lucene_data</code></p>
<h2>Consejos para Compatibilidad Multiplataforma</h2>
<ul>
<li><strong>Volúmenes de Docker</strong>: El volumen <code>lucene_data</code> asegura la persistencia de los índices entre reinicios del contenedor y es compatible con todas las plataformas soportadas por Docker.</li>
<li><strong>Analizadores Específicos</strong>: Para textos en español, usa <code>SpanishAnalyzer</code>:</li>
</ul>
<p><code>xml
  &lt;dependency&gt;
      &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;
      &lt;artifactId&gt;lucene-analyzers-common&lt;/artifactId&gt;
      &lt;version&gt;9.11.1&lt;/version&gt;
  &lt;/dependency&gt;</code></p>
<p><code>java
  import org.apache.lucene.analysis.es.SpanishAnalyzer;
  StandardAnalyzer analyzer = new SpanishAnalyzer();</code></p>
<ul>
<li><strong>WSL-Specific Notes</strong>: En WSL, asegúrate de que Docker Desktop esté integrado con WSL2 o usa la instalación manual de Docker. Los índices persisten en el volumen Docker, accesible desde el host.</li>
<li><strong>Compresión de Índices</strong>: Habilita compresión para optimizar almacenamiento:</li>
</ul>
<p><code>java
  config.setUseCompoundFile(true);</code></p>
<h2>Resolución de Problemas</h2>
<ul>
<li><strong>El Contenedor No Inicia</strong>:
  Revisa los logs:</li>
</ul>
<p><code>bash
  docker logs lucene</code></p>
<p>Problemas comunes: errores de compilación (verifica <code>pom.xml</code>), permisos en el directorio de índices, o falta de memoria.</p>
<ul>
<li><strong>Índices No Persisten</strong>:
  Verifica que el volumen <code>lucene_data</code> exista:</li>
</ul>
<p><code>bash
  docker volume ls | grep lucene_data</code></p>
<ul>
<li><strong>Resultados de Búsqueda Inesperados</strong>:
  Asegúrate de que el analizador usado en la indexación (<code>StandardAnalyzer</code>) coincida con el de la búsqueda. Revisa la consulta en <code>QueryParser</code>.</li>
</ul>
<h2>Recursos Adicionales</h2>
<ul>
<li><a href="https://lucene.apache.org/core/9_11_1/">Documentación de Apache Lucene</a></li>
<li><a href="https://maven.apache.org/guides/">Guía de Maven</a></li>
<li><a href="https://hub.docker.com/_/maven">Docker Java Image</a></li>
</ul>
<h2>Volver a su ficha</h2>
<p><a href="../tecnologias/lucene.html">Volver a la ficha de Lucene</a></p></body></html>